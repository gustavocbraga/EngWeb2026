extends layout

block content
  .w3-card-4
    header.w3-container.w3-green 
      h2= emd ? "Editar Exame médico" : "Criar novo exame médico"
    
    form.w3-container.w3-padding-16(method="POST" action=emd ? `/emd/${emd.id}` : "/emd")
      fieldset
        legend Dados Pessoais
        if emd
          input(type="hidden" name="id" value=emd.id)
          input(type="hidden" name="index" value=emd.index)

        label Data do Exame
          input.w3-input.w3-round(type="text" name="dataEMD" value=emd ? emd.dataEMD : "")

        label Email
          input.w3-input.w3-round(type="text" name="email" value=emd ? emd.email : "")
        
        label Nome do paciente 
          .w3-row-padding(style="margin:0 -16px;")
            .w3-half
              input.w3-input.w3-round(type="text" name="primeiro" placeholder="Primeiro nome" value=emd ? emd.nome.primeiro : "")
            .w3-half
              //- FIX: Changed 'segundo' to 'ultimo' to match DB key 'último'
              input.w3-input.w3-round(type="text" name="ultimo" placeholder="Último nome" value=emd ? emd.nome.último : "")

        .w3-row-padding(style="margin:0 -16px;")
          .w3-half
            label Idade
            input.w3-input.w3-round(type="number" name="idade" value=emd ? emd.idade : "")
          .w3-half
            label Género
            select.w3-select.w3-border.w3-round(name="género")
              option(value="M" selected=(emd && emd.género == 'M')) Masculino
              option(value="F" selected=(emd && emd.género == 'F')) Feminino

        label Morada
          input.w3-input.w3-round(type="text" name="morada" value=emd ? emd.morada : "")

      fieldset.w3-margin-top
        legend Dados Desportivos
        
        label Clube
          input.w3-input.w3-round(type="text" name="clube" value=emd ? emd.clube : "")
        
        label Modalidade
          input.w3-input.w3-round(type="text" name="modalidade" value=emd ? emd.modalidade : "")
        
        .w3-row-padding(style="margin:0 -16px;")
          .w3-half
            label Federado
            select.w3-select.w3-border.w3-round(name="federado")
              option(value="true" selected=(emd && emd.federado == true)) Sim
              option(value="false" selected=(emd && emd.federado == false)) Não
              
          .w3-half
            label Resultado
            select.w3-select.w3-border.w3-round(name="resultado")
              option(value="true" selected=(emd && emd.resultado == true)) Apto
              option(value="false" selected=(emd && emd.resultado == false)) Não Apto
              
      button.w3-btn.w3-green.w3-margin-top(type="submit")= emd ? "Update" : "Insert"
      a.w3-btn.w3-grey.w3-margin-top.w3-margin-left(href="/") Cancel